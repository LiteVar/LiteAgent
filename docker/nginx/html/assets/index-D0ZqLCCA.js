import{u as b,e as N,r as f,j as e,q as y,s as v,R as P}from"./index-Bqd9ntWg.js";import{L as k}from"./logo-DI8TcUuy.js";import{u as A,f as C}from"./query.gen-DycqmmC7.js";import{I as i,R as F}from"./ResponseCode-DASChpIM.js";import{F as t}from"./index-BesF1Zzs.js";import{I as q}from"./index-BjgghHgF.js";import{B as j}from"./button-w-BhhqNe.js";import{s as B}from"./index-D_2ZsiUY.js";import"./LeftOutlined-SuJsU2gG.js";import"./asyncToGenerator-C_d2R9__.js";import"./compact-item-BLNrSCAv.js";import"./useZIndex-CxNEmHgd.js";import"./render-CvJz5-Mq.js";import"./SwapOutlined-BPIwuBYF.js";const I=[{required:!0,message:"请输入新密码"},{min:8,message:"密码至少需要8个字符"},{max:20,message:"密码最多不能超过20个字符"},{validator:(l,a)=>/[a-zA-Z]/.test(a)?/\d/.test(a)?Promise.resolve():Promise.reject("密码必须包含至少一个数字"):Promise.reject("密码必须包含至少一个字母")}],Q=()=>{const[l]=t.useForm();b();const[a]=N(),d=a.get("token"),[o,n]=f.useState(1),{data:r}=A({...C({query:{token:d}})}),m=r==null?void 0:r.data,x=typeof(r==null?void 0:r.code)=="number"&&(r==null?void 0:r.code)!==200;f.useEffect(()=>{x&&n(-1)},[x]);const w=(c,s)=>!s||l.getFieldValue("password")===s?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致")),g=async c=>{var p,u,h;const s=await y({query:{token:d,username:c.username,password:c.password}});((p=s==null?void 0:s.data)==null?void 0:p.code)===F.S_OK?(v((u=s==null?void 0:s.data)==null?void 0:u.data),window.location.href=P.DASHBOARD):B.error(((h=s==null?void 0:s.data)==null?void 0:h.message)||"网络错误")};return e.jsxs("div",{className:"min-h-screen bg-[#F0F3F7] flex flex-col justify-center sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md flex items-center justify-center mb-16",children:[e.jsx(q,{preview:!1,className:"mr-8 h-12 w-auto",src:k,alt:"LiteAgent"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"LiteAgent"})]}),o===-1&&e.jsx("div",{children:e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"py-8 px-4 sm:rounded-lg sm:px-10 flex flex-col items-center",children:e.jsx("div",{className:"w-fit py-4 px-12 border border-[#F44336] border-solid rounded-md text-base text-center",children:"邀请已过期，请联系管理员"})})})}),o===1&&e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"py-8 px-4 sm:rounded-lg sm:px-10 flex flex-col items-center",children:[e.jsx("div",{className:"w-fit py-4 px-12 border border-[#CCCCCC] border-solid rounded-md text-base text-center",children:m==null?void 0:m.workspaceName}),e.jsx("div",{className:"w-fit text-base mt-5 mb-16",children:"邀请您加入工作空间"}),e.jsx(j,{type:"primary",size:"large",className:"w-56",onClick:()=>n(2),children:"加入"})]})}),o===2&&e.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"text-base text-center mb-12",children:"请设置您的账号信息"}),e.jsx("div",{className:"px-4 sm:rounded-lg sm:px-10",children:e.jsxs(t,{form:l,name:"normal_login",className:"login-form",initialValues:{remember:!0,email:m==null?void 0:m.email},onFinish:g,children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("label",{className:"w-24 text-right text-base mr-6",children:"账号:"}),e.jsx(t.Item,{style:{marginBottom:0,width:"266px"},name:"email",rules:[{required:!0,message:"请输入您的账号"}],children:e.jsx(i,{disabled:!0,placeholder:"请输入您的账号"})})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("label",{className:"w-24 text-right text-base mr-6",children:"昵称:"}),e.jsx(t.Item,{style:{marginBottom:0,width:"266px"},name:"username",rules:[{required:!0,message:"请输入您的昵称"}],children:e.jsx(i,{placeholder:"请输入您的昵称"})})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("label",{className:"w-24 text-right text-base mr-6",children:"新密码:"}),e.jsx(t.Item,{style:{marginBottom:0,width:"266px"},name:"password",rules:I,children:e.jsx(i,{type:"password",placeholder:"请输入新密码"})})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("label",{className:"w-24 text-right text-base mr-6",children:"新密码确认:"}),e.jsx(t.Item,{style:{marginBottom:0,width:"266px"},name:"confirmPassword",rules:[{required:!0,message:"请再次输入新密码"},{validator:w}],children:e.jsx(i,{type:"password",placeholder:"请再次输入新密码"})})]}),e.jsx(t.Item,{children:e.jsx(j,{type:"primary",htmlType:"submit",size:"large",className:"w-full mt-12",children:"登录"})})]})})]})]})};export{Q as default};
